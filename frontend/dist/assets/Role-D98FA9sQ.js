import{h as m}from"./http-Cn7TCoTQ.js";import{_ as A}from"./EntityForm.vue_vue_type_script_setup_true_lang-CkomLGgO.js";import{d as G,c as B,a as N,b as t,w as o,i as n,r as d,o as V,g as u,j as H,k as J,F as K,l as P,h as Q,m as W,_ as X}from"./index-CkmIPjxY.js";const Y={class:"toolbar"},Z={class:"pager"},h=G({__name:"Role",setup(ee){const g=n(""),C=n([]),_=n(1),b=n(10),w=n(0),r=n(!1),v=n(!1);let i=Q({});const k=n(null),z=n([]),f=n([]),U=[{key:"name",label:"名称"},{key:"identity",label:"标识"},{key:"description",label:"描述"}],p=async()=>{const a=await m.get("/roles/page",{params:{pageNum:_.value,pageSize:b.value,name:g.value}});C.value=a.data.data.content,w.value=a.data.data.totalElements},j=()=>{Object.keys(i).forEach(a=>delete i[a]),r.value=!0},I=a=>{Object.assign(i,a),r.value=!0},R=async()=>{await m.post("/roles",i),r.value=!1,p()},S=async a=>{await m.delete(`/roles/${a}`),p()},E=async a=>{k.value=a.id;const e=await m.get("/menus/ids");z.value=e.data.data;const y=await m.get(`/roles/checks/${a.id}`);f.value=y.data.data,v.value=!0},D=async()=>{k.value&&(await m.post(`/roles/roleMenu/${k.value}`,f.value),v.value=!1)},F=a=>{b.value=a,p()},M=a=>{_.value=a,p()};return p(),(a,e)=>{const y=d("el-input"),s=d("el-button"),c=d("el-table-column"),O=d("el-table"),L=d("el-pagination"),x=d("el-dialog"),T=d("el-option"),q=d("el-select");return V(),B("div",null,[N("div",Y,[t(y,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l),placeholder:"角色名称",class:"field"},null,8,["modelValue"]),t(s,{onClick:p},{default:o(()=>[...e[7]||(e[7]=[u("查询",-1)])]),_:1}),t(s,{type:"success",onClick:j},{default:o(()=>[...e[8]||(e[8]=[u("新增",-1)])]),_:1})]),t(O,{data:C.value,border:""},{default:o(()=>[t(c,{prop:"name",label:"名称"}),t(c,{prop:"identity",label:"标识"}),t(c,{prop:"description",label:"描述"}),t(c,{label:"操作",width:"220"},{default:o(l=>[t(s,{size:"small",onClick:$=>I(l.row)},{default:o(()=>[...e[9]||(e[9]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(s,{size:"small",type:"primary",onClick:$=>E(l.row)},{default:o(()=>[...e[10]||(e[10]=[u("绑定菜单",-1)])]),_:1},8,["onClick"]),t(s,{size:"small",type:"danger",onClick:$=>S(l.row.id)},{default:o(()=>[...e[11]||(e[11]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),N("div",Z,[t(L,{layout:"total, sizes, prev, pager, next, jumper",total:w.value,"page-size":b.value,"current-page":_.value,"page-sizes":[5,10,20],onSizeChange:F,onCurrentChange:M},null,8,["total","page-size","current-page"])]),t(x,{modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=l=>r.value=l),title:"角色",width:"600px"},{footer:o(()=>[t(s,{onClick:e[2]||(e[2]=l=>r.value=!1)},{default:o(()=>[...e[12]||(e[12]=[u("取消",-1)])]),_:1}),t(s,{type:"primary",onClick:R},{default:o(()=>[...e[13]||(e[13]=[u("保存",-1)])]),_:1})]),default:o(()=>[t(A,{modelValue:J(i),"onUpdate:modelValue":e[1]||(e[1]=l=>H(i)?i.value=l:i=l),fields:U},null,8,["modelValue"])]),_:1},8,["modelValue"]),t(x,{modelValue:v.value,"onUpdate:modelValue":e[6]||(e[6]=l=>v.value=l),title:"绑定菜单",width:"500px"},{footer:o(()=>[t(s,{onClick:e[5]||(e[5]=l=>v.value=!1)},{default:o(()=>[...e[14]||(e[14]=[u("取消",-1)])]),_:1}),t(s,{type:"primary",onClick:D},{default:o(()=>[...e[15]||(e[15]=[u("保存",-1)])]),_:1})]),default:o(()=>[t(q,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=l=>f.value=l),multiple:"",filterable:"",style:{width:"100%"}},{default:o(()=>[(V(!0),B(K,null,P(z.value,l=>(V(),W(T,{key:l,value:l,label:String(l)},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),oe=X(h,[["__scopeId","data-v-ab69f083"]]);export{oe as default};
